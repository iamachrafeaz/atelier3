<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:head>
    <meta charset="UTF-8"/>
    <title>My Orders</title>
    <h:outputStylesheet>
        body {
            background-color: #f5f5f7;
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", sans-serif;
            color: #1f2937;
        }

        .orders-container {
            max-width: 1152px;
            margin: 6rem auto 0;
            padding: 0 1.5rem;
        }

        .orders-title {
            font-size: 1.875rem;
            font-weight: 600;
            margin-bottom: 2rem;
        }

        .empty-orders {
            text-align: center;
            color: #6b7280;
            margin-top: 5rem;
        }

        .browse-btn {
            margin-top: 1.5rem;
        }

        .ui-datatable {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }

        .ui-datatable thead th {
            background: white;
            color: #374151;
            font-weight: 500;
            border-bottom: 1px solid #e5e7eb;
            padding: 1rem 1.5rem;
        }

        .ui-datatable tbody td {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #f3f4f6;
        }

        .ui-datatable tbody tr:hover {
            background-color: #f9fafb;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
            display: inline-block;
        }

        .status-pending {
            background-color: #fef3c7;
            color: #92400e;
        }

        .status-processing {
            background-color: #dbeafe;
            color: #1e40af;
        }

        .status-completed {
            background-color: #d1fae5;
            color: #065f46;
        }

        .status-canceled {
            background-color: #fee2e2;
            color: #991b1b;
        }

        .status-unknown {
            background-color: #f3f4f6;
            color: #1f2937;
        }

        .ui-button.view-btn {
            background-color: #000;
            border: none;
            border-radius: 0.75rem;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            color: white;
        }

        .ui-button.view-btn:hover {
            background-color: #1f2937;
        }

        .ui-button.browse-products-btn {
            background-color: #000;
            border: none;
            border-radius: 0.75rem;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
        }

        .ui-button.browse-products-btn:hover {
            background-color: #1f2937;
        }

        .order-id {
            font-weight: 500;
        }

        .order-total {
            font-weight: 500;
        }
    </h:outputStylesheet>
</h:head>

<ui:include src="../navbar.xhtml"/>

<h:body styleClass="apple-font text-gray-800" style="margin-top: 70px">
    <!-- Success/Error Messages -->
    <p:growl id="messages" showDetail="true" life="3000"/>

    <div class="orders-container">
        <h1 class="orders-title">My Orders</h1>

        <h:form id="ordersForm">
            <!-- Empty Orders Message -->
            <h:panelGroup rendered="#{empty orderBean.orders}">
                <p class="empty-orders">You have not placed any orders yet.</p>
<!--                <div style="text-align: center;" class="browse-btn">-->
<!--                    <p:button value="Browse Products"-->
<!--                              outcome="/pages/product.xhtml"-->
<!--                              styleClass="browse-products-btn"/>-->
<!--                </div>-->
            </h:panelGroup>

            <!-- Orders Table -->
            <h:panelGroup rendered="#{not empty orderBean.orders}">
                <p:dataTable id="ordersTable"
                             value="#{orderBean.orders}"
                             var="order"
                             styleClass="orders-datatable"
                             emptyMessage="No orders found">

                    <!-- Order ID Column -->
                    <p:column headerText="Order ID">
                        <span class="order-id">##{order.id}</span>
                    </p:column>

                    <!-- Date Column -->
                    <p:column headerText="Date">
                        <h:outputText value="#{order.createdAt}">
                            <f:convertDateTime pattern="MMM dd, yyyy HH:mm" />
                        </h:outputText>
                    </p:column>

                    <!-- Status Column -->
                    <p:column headerText="Status">
                        <h:panelGroup rendered="#{order.status.name() == 'PENDING'}">
                            <span class="status-badge status-pending">Pending</span>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{order.status.name() == 'PROCESSING'}">
                            <span class="status-badge status-processing">Processing</span>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{order.status.name() == 'COMPLETED'}">
                            <span class="status-badge status-completed">Completed</span>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{order.status.name() == 'CANCELED'}">
                            <span class="status-badge status-canceled">Canceled</span>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{order.status.name() != 'PENDING' and order.status.name() != 'PROCESSING' and order.status.name() != 'COMPLETED' and order.status.name() != 'CANCELED'}">
                            <span class="status-badge status-unknown">Unknown</span>
                        </h:panelGroup>
                    </p:column>

                    <!-- Total Column -->
                    <p:column headerText="Total">
                        <span class="order-total">
                            <h:outputText value="$#{order.total}">
                                <f:convertNumber pattern="#0.00"/>
                            </h:outputText>
                        </span>
                    </p:column>

                    <!-- Action Column -->
                    <p:column headerText="Action">
                        <p:button value="View"
                                  outcome="/order/order.xhtml"
                                  styleClass="view-btn">
                            <f:param name="id" value="#{order.id}"/>
                        </p:button>
                    </p:column>
                </p:dataTable>
            </h:panelGroup>
        </h:form>
    </div>
</h:body>
</html>