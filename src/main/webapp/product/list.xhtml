<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:head>
    <meta charset="UTF-8"/>
    <title>Products</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #f5f5f7;
        }
        .apple-font {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", sans-serif;
        }
        .glass {
            backdrop-filter: blur(16px);
            background-color: rgba(255, 255, 255, 0.65);
        }
    </style>
</h:head>

<ui:include src="../navbar.xhtml"/>

<h:body styleClass="apple-font text-gray-800" style="margin-top: 70px">


    <!-- Search Bar -->
    <h:form id="searchForm" class="max-w-4xl mx-auto flex items-center gap-2 mb-6 mt-10">
        <p:inputText value="#{productBean.searchTerm}" placeholder="Search products..."
                     styleClass="flex-1 px-4 py-2 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-black transition" />
        <p:commandButton value="Search" actionListener="#{productBean.search}"
                         styleClass="bg-black text-white px-4 py-2 rounded-xl hover:bg-gray-800 transition" />
    </h:form>

    <!-- Products Grid -->
    <div class="max-w-6xl mx-auto grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
        <ui:repeat value="#{productBean.products}" var="p">
            <p:panel styleClass="glass p-4 flex flex-col items-center rounded-2xl shadow-lg transition hover:shadow-2xl">

                <!-- Product Image -->
                <h:panelGroup>
                    <h:graphicImage value="/uploads/#{p.image}" rendered="#{not empty p.image}"
                                    styleClass="w-40 h-40 object-cover rounded-xl mb-4"/>
                    <h:outputText value="No Image" rendered="#{empty p.image}"
                                  styleClass="text-gray-400 mb-4"/>
                </h:panelGroup>

                <!-- Product Label -->
                <h:outputText value="#{p.label}" styleClass="text-lg font-semibold mb-2 text-center"/>

                <!-- Price -->
                <h:outputText value="$#{p.price}" styleClass="text-xl font-bold mb-2"/>

                <!-- Stock Status -->
                <h:outputText value="In Stock" styleClass="text-green-600 mb-4" rendered="#{p.inventoryQty gt 0}"/>
                <h:outputText value="Out of Stock" styleClass="text-red-600 mb-4" rendered="#{p.inventoryQty le 0}"/>

                <!-- View Link -->
                <p:link value="View" outcome="product?faces-redirect=true"
                        styleClass="bg-black text-white px-4 py-2 rounded-xl hover:bg-gray-800 transition">
                    <f:param name="id" value="#{p.id}" />
                </p:link>
            </p:panel>
        </ui:repeat>
    </div>

</h:body>
</html>
